(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{252:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=s(5155),a=s(2115),n=s(2370),i=s(285),l=s(6695),o=s(2523),c=s(5057),d=s(704),u=s(9434);let f=d.bL,p=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(d.B8,{ref:t,className:(0,u.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});p.displayName=d.B8.displayName;let m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(d.l9,{ref:t,className:(0,u.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});m.displayName=d.l9.displayName;let g=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(d.UC,{ref:t,className:(0,u.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});g.displayName=d.UC.displayName;var h=s(7481),v=s(5695),x=s(1776),y=s(697);function b(){let[e,t]=(0,a.useState)(""),[s,d]=(0,a.useState)(""),[u,b]=(0,a.useState)(""),[j,w]=(0,a.useState)(""),[S,N]=(0,a.useState)(""),[T,A]=(0,a.useState)(!1),{setSession:C}=(0,x.Z)(),{toast:k}=(0,h.dj)(),E=(0,v.useRouter)(),_=async e=>{e.preventDefault(),A(!0);try{let e=await (0,n.Hh)({name:S,email:u,password:j});C(e),k({title:"Success",description:"Account created successfully. Redirecting..."}),E.push("/")}catch(e){k({title:"Error signing up",description:e instanceof y.hD?e.message:(null==e?void 0:e.message)||"Failed to sign up",variant:"destructive"})}finally{A(!1)}},R=async t=>{t.preventDefault(),A(!0);try{let t=await (0,n.Jv)({email:e,password:s});C(t),k({title:"Success",description:"Signed in successfully. Redirecting..."}),E.push("/")}catch(e){k({title:"Error signing in",description:e instanceof y.hD?e.message:(null==e?void 0:e.message)||"Failed to sign in",variant:"destructive"})}finally{A(!1)}};return(0,r.jsx)("div",{className:"container flex min-h-[calc(100vh-theme(spacing.14))] items-center justify-center py-12",children:(0,r.jsxs)(f,{defaultValue:"signin",className:"w-[400px]",children:[(0,r.jsxs)(p,{className:"grid w-full grid-cols-2",children:[(0,r.jsx)(m,{value:"signin",children:"Sign In"}),(0,r.jsx)(m,{value:"signup",children:"Sign Up"})]}),(0,r.jsx)(g,{value:"signin",children:(0,r.jsx)(l.Zp,{children:(0,r.jsxs)("form",{onSubmit:R,children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Sign In"}),(0,r.jsx)(l.BT,{children:"Access your WhisperNet account."})]}),(0,r.jsxs)(l.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.J,{htmlFor:"signin-email",children:"Email"}),(0,r.jsx)(o.p,{id:"signin-email",type:"email",placeholder:"m@example.com",value:e,onChange:e=>t(e.target.value),required:!0,disabled:T})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.J,{htmlFor:"signin-password",children:"Password"}),(0,r.jsx)(o.p,{id:"signin-password",type:"password",value:s,onChange:e=>d(e.target.value),required:!0,disabled:T})]})]}),(0,r.jsx)(l.wL,{children:(0,r.jsx)(i.$,{type:"submit",className:"w-full",disabled:T,children:T?"Signing In...":"Sign In"})})]})})}),(0,r.jsx)(g,{value:"signup",children:(0,r.jsx)(l.Zp,{children:(0,r.jsxs)("form",{onSubmit:_,children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Sign Up"}),(0,r.jsx)(l.BT,{children:"Create a new WhisperNet account to start posting."})]}),(0,r.jsxs)(l.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.J,{htmlFor:"signup-name",children:"Display Name"}),(0,r.jsx)(o.p,{id:"signup-name",type:"text",placeholder:"John Doe",value:S,onChange:e=>N(e.target.value),required:!0,disabled:T})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.J,{htmlFor:"signup-email",children:"Email"}),(0,r.jsx)(o.p,{id:"signup-email",type:"email",placeholder:"m@example.com",value:u,onChange:e=>b(e.target.value),required:!0,disabled:T})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.J,{htmlFor:"signup-password",children:"Password"}),(0,r.jsx)(o.p,{id:"signup-password",type:"password",value:j,onChange:e=>w(e.target.value),required:!0,disabled:T})]})]}),(0,r.jsx)(l.wL,{children:(0,r.jsx)(i.$,{type:"submit",className:"w-full",disabled:T,children:T?"Creating Account...":"Create Account"})})]})})})]})})}},285:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var r=s(5155),a=s(2115),n=s(9708),i=s(2085),l=s(9434);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:c=!1,...d}=e,u=c?n.DX:"button";return(0,r.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:s})),ref:t,...d})});c.displayName="Button"},697:(e,t,s)=>{"use strict";var r;s.d(t,{AT:()=>i,hD:()=>n});let a=(null==(r=s(7358).env.NEXT_PUBLIC_API_BASE_URL)?void 0:r.replace(/\/$/,""))||"http://localhost:4000";class n extends Error{constructor(e,t,s){super(e),this.name="ApiError",this.status=t,this.data=s}}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(a).concat(e.startsWith("/")?e:"/".concat(e)),r=new Headers(t.headers||{});t.body instanceof FormData||r.set("Content-Type","application/json"),r.set("Accept","application/json"),t.token&&r.set("Authorization","Bearer ".concat(t.token));let i=await fetch(s,{...t,headers:r,next:{revalidate:0}}),l=i.headers.get("content-type"),o=(null==l?void 0:l.includes("application/json"))?await i.json():void 0;if(!i.ok)throw new n((null==o?void 0:o.message)||"Request failed with status ".concat(i.status),i.status,o);return o}},1776:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>d,Z:()=>u});var r=s(5155),a=s(2115);let n="anonymous-social-session";function i(e){localStorage.setItem(n,JSON.stringify(e))}function l(){localStorage.removeItem(n)}var o=s(2370);let c=(0,a.createContext)(void 0);function d(e){let{children:t}=e,[s,d]=(0,a.useState)(null),[u,f]=(0,a.useState)(null),[p,m]=(0,a.useState)(!0),[g,h]=(0,a.useState)(null),v=(0,a.useCallback)(async()=>{let e=function(){let e=localStorage.getItem(n);if(!e)return null;try{return JSON.parse(e)}catch(e){return localStorage.removeItem(n),null}}();if(!e)return void m(!1);d(e.user),f(e.token);try{let t=await (0,o.rQ)(e.token);d(t),i({token:e.token,user:t}),h(null)}catch(e){console.error("[AuthProvider] Failed to refresh user",e),l(),d(null),f(null),h("Session expired. Please sign in again.")}finally{m(!1)}},[]);(0,a.useEffect)(()=>{v()},[v]);let x=(0,a.useCallback)(e=>{i(e),d(e.user),f(e.token),h(null)},[]),y=(0,a.useCallback)(()=>{l(),d(null),f(null)},[]),b=(0,a.useCallback)(async()=>{if(u)try{m(!0);let e=await (0,o.rQ)(u);d(e),i({token:u,user:e}),h(null)}catch(e){console.error("[AuthProvider] refreshUser failed",e),y()}finally{m(!1)}},[u,y]),j=(0,a.useMemo)(()=>({user:s,token:u,loading:p,error:g,setSession:x,signOut:y,refreshUser:b}),[s,u,p,g,x,y,b]);return(0,r.jsx)(c.Provider,{value:j,children:t})}function u(){let e=(0,a.useContext)(c);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}},2370:(e,t,s)=>{"use strict";s.d(t,{Hh:()=>a,Jv:()=>n,rQ:()=>i});var r=s(697);async function a(e){return(0,r.AT)("/api/auth/signup",{method:"POST",body:JSON.stringify(e)})}async function n(e){return(0,r.AT)("/api/auth/login",{method:"POST",body:JSON.stringify(e)})}async function i(e){return(await (0,r.AT)("/api/auth/me",{method:"GET",token:e})).user}},2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var r=s(5155),a=s(2115),n=s(9434);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},3765:(e,t,s)=>{Promise.resolve().then(s.bind(s,252))},5057:(e,t,s)=>{"use strict";s.d(t,{J:()=>c});var r=s(5155),a=s(2115),n=s(2797),i=s(2085),l=s(9434);let o=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.b,{ref:t,className:(0,l.cn)(o(),s),...a})});c.displayName=n.b.displayName},6695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>i,aR:()=>l,wL:()=>u});var r=s(5155),a=s(2115),n=s(9434);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},7481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>f});var r=s(2115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function f(){let[e,t]=r.useState(c);return r.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,s)=>{"use strict";s.d(t,{E:()=>l,cn:()=>n,f:()=>i});var r=s(2596),a=s(9688);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}function i(e){try{let t=new Date(e),s=new Date().getTime()-t.getTime(),r=Math.floor(s/1e3),a=Math.floor(r/60),n=Math.floor(a/60),i=Math.floor(n/24),l=Math.floor(i/7),o=Math.floor(i/30),c=Math.floor(i/365);if(r<60)return"just now";if(a<60)return"".concat(a,"m ago");if(n<24)return"".concat(n,"h ago");else if(i<7)return"".concat(i,"d ago");else if(l<4)return"".concat(l,"w ago");else if(o<12)return"".concat(o,"mo ago");else return"".concat(c,"y ago")}catch(e){return"unknown time"}}function l(e,t){return e.length<=t?e:e.slice(0,t).trim()+"..."}}},e=>{var t=t=>e(e.s=t);e.O(0,[352,620,978,441,684,358],()=>t(3765)),_N_E=e.O()}]);